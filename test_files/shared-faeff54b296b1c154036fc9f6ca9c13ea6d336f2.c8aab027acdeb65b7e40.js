(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[7137],{96159:function(e,t,n){"use strict";n.d(t,{Z:function(){return v},A:function(){return w}});var i=n(85879),r=n(58216),o=n(87363),a=n(3426),c=n(22107),s=n(94707),l=n(87320),u=n(86325),d=n(85626),p=n(14168),h=n.n(p),m=n(25628),f=n.n(m),g=function(e){(0,u._)(n,e);var t=(0,d._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,s._)(n,[{key:"render",value:function(){var e=this.props,t=e.showReport,n=e.className,r=e.onReportClick,o=e.onMessageDelete,a=e.onMultiSelectClick;return(0,i.BX)("ul",{className:f()("ActionMenu",n),children:[(0,i.tZ)("li",{className:"ActionMenu-item",onClick:o,children:"删除"}),t&&(0,i.tZ)("li",{className:"ActionMenu-item",onClick:r,children:"举报"}),t&&(0,i.tZ)("li",{className:"ActionMenu-item",onClick:a,children:"多选"})]})}}]),n}(o.Component);(0,l._)(g,"propsTypes",{className:h().string,showReport:h().bool,onMessageDelete:h().func.isRequired,onReportClick:h().func.isRequired,onMultiSelectClick:h().func.isRequired});var v=(0,o.forwardRef)(function(e,t){var n=e.isOpen,c=e.onToggleMenu,s=e.onDeleteClick,l=e.onReportClick,u=e.onMultiSelectClick,d=e.showReport;(0,o.useEffect)(function(){if(n)return window.addEventListener("wheel",c),function(){window.removeEventListener("wheel",c)}},[n,c]);var p=(0,o.useCallback)(function(e){e.stopPropagation(),c()},[c]);return(0,i.BX)(i.HY,{children:[(0,i.tZ)("button",{type:"button",onClick:p,"aria-label":"更多",ref:t,className:"Chat-ActionMenuPopover-Button",children:(0,i.tZ)(r.AZ,{className:"Message-status--more"})}),(0,i.tZ)(a.Z,{isOpen:n,fixed:!0,arrowed:!0,target:null==t?void 0:t.current,children:(0,i.tZ)(g,{onMessageDelete:s,onReportClick:l,onMultiSelectClick:u,showReport:d})})]})}),b=n(94009),w=function(e){var t=e.handleDeleteClick,n=e.handleReportClick,r=e.showReport,a=(0,b._)((0,o.useState)(!1),2),c=a[0],s=a[1],l=(0,o.useRef)(),u=(0,o.useCallback)(function(){s(function(e){return!e})},[]),d=(0,o.useCallback)(function(){s(!1)},[]),p=function(e){!c||!l.current||l.current.contains(e.target)||(s(!1),e.stopPropagation(),e.preventDefault())};return(0,o.useEffect)(function(){return document.addEventListener("click",p),function(){document.removeEventListener("click",p)}},[c]),{popover:(0,i.tZ)(v,{ref:l,isOpen:c,onToggleMenu:u,onDeleteClick:t,onReportClick:n,showReport:r}),handleMouseLeave:d}}},57029:function(e,t,n){"use strict";n.d(t,{_p:function(){return g},En:function(){return h},Ng:function(){return p},XP:function(){return f},eS:function(){return m},e5:function(){return d}});var i=n(85879),r=n(70877),o=n(99178),a=n(87641),c=n(87363),s=n(44169),l=(0,c.memo)(function(e){var t=e.time;if(!t)return null;var n=new Date(t);return(0,i.tZ)("time",{dateTime:n.toISOString(),children:new Date().getTime()-Number(n)<864e5?(0,s.Jd)(n):(0,s.ht)(n)})}),u=n(60051),d=function(e){var t=e.className,n=e.children;return(0,i.tZ)(a.Flex,{className:t,sx:{position:"relative",minWidth:"710px",minHeight:"600px",flexDirection:"column"},children:n})},p=function(e){var t=e.children;return(0,i.tZ)(a.Flex,{as:"header",fontSize:"15px",lineHeight:"20px",height:"50px",m:"0 14px",pb:"9px",pt:"21px",alignItems:"center",justifyContent:"center",fontWeight:"bold",sx:{borderBottom:"1px solid",borderColor:"GBK09A"},children:t})},h=function(e){var t=e.children;return(0,i.tZ)(a.Box,{flex:"auto",height:"362px",children:t})},m=function(e){var t=e.time;return(0,i.tZ)(a.Box,{pt:"15px",textAlign:"center",fontSize:"12px",lineHeight:"20px",color:"GBK06A",children:(0,i.tZ)(l,{time:t})})};function f(e){var t=e.className,n=e.message,r=e.isReceiver,o=e.user,c=e.renderAvatar,s=void 0===c?function(e){return(0,i.tZ)(u.Z,{linkProps:{},user:e||{},size:40})}:c,l=e.renderMessage;return(0,i.BX)(a.Flex,{className:t,m:"20px",alignItems:"flex-start",flexDirection:r?"row-reverse":"initial",children:[(0,i.tZ)(a.Flex,{alignItems:"center",children:null==s?void 0:s(o)}),(0,i.tZ)(a.Flex,{m:"0 10px",alignItems:"center",flexDirection:r?"row-reverse":"initial",children:(null==l?void 0:l(n))||null})]})}function g(e){var t=e.sender,n=e.receiver,c=e.isEmpty,s=e.isLoading,l=e.onLoad,u=e.messages,g=e.renderMessage,v=e.onRef;return(0,i.BX)(d,{children:[(0,i.tZ)(p,{children:(null==t?void 0:t.name)||""}),(0,i.tZ)(h,{children:c&&s?(0,i.tZ)(r.Z,{css:{margin:"20px auto 0"}}):(0,i.tZ)(o.ZP,{isLoading:s,onLoad:l,placeholder:(0,i.tZ)(r.Z,{css:{margin:"20px auto 0"}}),isPrevDrained:!1,isDrained:!0,getContainer:function(e){return e},css:{height:"100%",flexShrink:0,"-webkit-overflow-scrolling":"touch",overflowY:"scroll"},onRef:v,children:u.map(function(e){var r=e.showTime,o=e.createdTime,a="receiver"===e.userType;return(0,i.BX)("div",{children:[r&&(0,i.tZ)(m,{time:o}),(0,i.tZ)(f,{message:e,user:a?n:t,isReceiver:a,renderMessage:g})]},e.id)})})}),(0,i.tZ)(a.Box,{height:"169px",mx:"14px",sx:{borderTop:"1px solid",borderColor:"GBK09A"}})]})}},66857:function(e,t,n){"use strict";var i=n(94009),r=n(85879),o=n(65733),a=n(25628),c=n.n(a),s=n(53967),l=n.n(s),u=n(87363),d=n(87641),p=n(69383),h=n(60683),m=function(e){var t=e.message,n=(0,u.useRef)(),o=(0,i._)((0,u.useState)(!1),2),a=o[0],c=o[1];return(0,r.tZ)(d.Text,{ref:n,color:a?"inherit":"primary",css:{cursor:a?"text":"pointer"},onClick:function(){a||(c(!0),p.Z.trackEvent(n.current,{action:"Click",id:6880}))},dangerouslySetInnerHTML:{__html:a?t.richText||t.text:t.extraContent}})};t.Z=function(e){var t=e.message,n=e.senderId,i=e.sendMessage,a=function(e){var t,n=null===(t=e.match(/"zhihu:\/\/popup_container.*?"/))||void 0===t?void 0:t[0];if(n)return function(e,t){var n,i,r=null===(n=decodeURIComponent(null===(i=null==t?void 0:t.split("url="))||void 0===i?void 0:i[1]))||void 0===n?void 0:n.slice(0,-1);if(!l()(r))return e;var o=new URL(r);if("/appview/help_center/answer_pop"===o.pathname){var a='"'.concat(window.location.origin,"/help-center/faqId/-2?").concat(o.search,'"');return e.replace(t,a)}return e.replace(t,o.href)}(e,n)}(t.richText)||t.text,s=(0,o.Z)(function(e){if("A"===e.target.tagName&&e.target.href){var t=e.target.href,r=new URLSearchParams(t.split("?")[1]).get("message"),o=t.match(/www.zhihu.com\/inbox\/([\d\w]+)/);(null==o?void 0:o[1])&&n===o[1]&&(e.preventDefault(),i({contentType:h.wF.text,receiverId:n,data:{text:r}}))}});return(0,r.tZ)("div",{className:c()("TextMessage",{"TextMessage-sender":"sender"===t.userType,"TextMessage-receiver":"receiver"===t.userType}),children:t.unfriendly&&"sender"===t.userType?(0,r.tZ)(m,{message:t}):(0,r.tZ)(d.Text,{onClick:s,dangerouslySetInnerHTML:{__html:a}})})}},28834:function(e,t,n){"use strict";n.d(t,{Z:function(){return tt}});var i,r=n(20857),o=n(22107),a=n(94707),c=n(87320),s=n(86325),l=n(85626),u=n(85879),d=n(70877),p=n(99178),h=n(14168),m=n.n(h),f=n(87363),g=n.n(f),v=n(36695),b=n(19076),w=n(93206),x=n(55164),_=n(94009),y=n(84871),k=n.n(y),Z=n(74135),M=n(68455),C=n(49899),S=n(79855);function E(e){return e.reduce(function(e,t){var n;return(0,C._)(e).concat((0,C._)(null!==(n=t.stickers)&&void 0!==n?n:[]))},[])}var T=n(79281),R=n(91486),I=n(64011),B=n(87641),z=n(57730),N=n(76435),A=n(57665),D=n(60051),L=n(73718),P=n(48825),O=n(96159),U=n(60683),H=n(57477),K=n(19860),F=n(25628),G=n.n(F),W=n(69383),j=n(71542),q=n(43384),X=n(89551);function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function $(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Y=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(i=n(24429).props)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(i)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}(),["sx","variant"]),J=new RegExp("^(".concat(Y.join("|"),")$")),Q=/^m[trblxy]?$/,ee=function(e){return function(t){var n={};for(var i in t)e(i||"")&&(n[i]=t[i]);return n}},et=ee(function(e){return J.test(e)}),en=ee(function(e){return Q.test(e)}),ei=ee(function(e){return!Q.test(e)}),er=function(e){e.size;var t=$(e,["size"]);return g().createElement(X.xu,V({as:"svg",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentcolor"},t))};(0,f.forwardRef)(function(e,t){return g().createElement(X.kC,V({ref:t,as:"label",tx:"forms",variant:"label"},e,{__css:{width:"100%"}}))});var eo=(0,f.forwardRef)(function(e,t){return g().createElement(X.xu,V({ref:t,as:"input",type:"text",tx:"forms",variant:"input"},e,{__css:{display:"block",width:"100%",p:2,appearance:"none",fontSize:"inherit",lineHeight:"inherit",border:"1px solid",borderRadius:"default",color:"inherit",bg:"transparent"}}))}),ea=function(e){return g().createElement(er,e,g().createElement("path",{d:"M7 10l5 5 5-5z"}))};(0,f.forwardRef)(function(e,t){return g().createElement(X.kC,en(e),g().createElement(X.xu,V({ref:t,as:"select",tx:"forms",variant:"select"},ei(e),{__css:{display:"block",width:"100%",p:2,appearance:"none",fontSize:"inherit",lineHeight:"inherit",border:"1px solid",borderRadius:"default",color:"inherit",bg:"transparent"}})),g().createElement(ea,{sx:{ml:-28,alignSelf:"center",pointerEvents:"none"}}))}),(0,f.forwardRef)(function(e,t){return g().createElement(X.xu,V({ref:t,as:"textarea",tx:"forms",variant:"textarea"},e,{__css:{display:"block",width:"100%",p:2,appearance:"none",fontSize:"inherit",lineHeight:"inherit",border:"1px solid",borderRadius:"default",color:"inherit",bg:"transparent"}}))});var ec=function(e){return g().createElement(er,e,g().createElement("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}))},es=function(e){return g().createElement(er,e,g().createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}))},el=function(e){return g().createElement(g().Fragment,null,g().createElement(ec,V({},e,{__css:{display:"none","input:checked ~ &":{display:"block"}}})),g().createElement(es,V({},e,{__css:{display:"block","input:checked ~ &":{display:"none"}}})))};(0,f.forwardRef)(function(e,t){var n=e.className,i=e.sx,r=e.variant,o=$(e,["className","sx","variant"]);return g().createElement(X.xu,null,g().createElement(X.xu,V({ref:t,as:"input",type:"radio"},o,{sx:{position:"absolute",opacity:0,zIndex:-1,width:1,height:1,overflow:"hidden"}})),g().createElement(X.xu,V({as:el,"aria-hidden":"true",tx:"forms",variant:void 0===r?"radio":r,className:n,sx:i},et(o),{__css:{mr:2,borderRadius:9999,color:"gray","input:checked ~ &":{color:"primary"},"input:focus ~ &":{bg:"highlight"}}})))});var eu=function(e){return g().createElement(er,e,g().createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}))},ed=function(e){return g().createElement(er,e,g().createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}))},ep=function(e){return g().createElement(g().Fragment,null,g().createElement(eu,V({},e,{__css:{display:"none","input:checked ~ &":{display:"block"}}})),g().createElement(ed,V({},e,{__css:{display:"block","input:checked ~ &":{display:"none"}}})))};(0,f.forwardRef)(function(e,t){var n=e.className,i=e.sx,r=e.variant,o=$(e,["className","sx","variant"]);return g().createElement(X.xu,null,g().createElement(X.xu,V({ref:t,as:"input",type:"checkbox"},o,{sx:{position:"absolute",opacity:0,zIndex:-1,width:1,height:1,overflow:"hidden"}})),g().createElement(X.xu,V({as:ep,"aria-hidden":"true",tx:"forms",variant:void 0===r?"checkbox":r,className:n,sx:i},et(o),{__css:{mr:2,borderRadius:4,color:"gray","input:checked ~ &":{color:"primary"},"input:focus ~ &":{color:"primary",bg:"highlight"}}})))}),(0,f.forwardRef)(function(e,t){var n=V({},e);return g().createElement(X.xu,V({ref:t,as:"input",type:"range",tx:"forms",variant:"slider"},n,{__css:{display:"block",width:"100%",height:4,my:2,cursor:"pointer",appearance:"none",borderRadius:9999,color:"inherit",bg:"gray",":focus":{outline:"none",color:"primary"},"&::-webkit-slider-thumb":{appearance:"none",width:16,height:16,bg:"currentcolor",border:0,borderRadius:9999,variant:"forms.slider.thumb"}}}))}),(0,f.forwardRef)(function(e,t){var n=e.checked,i=$(e,["checked"]);return g().createElement(X.xu,V({ref:t,as:"button",type:"button",role:"switch",tx:"forms",variant:"switch","aria-checked":n},i,{__css:{appearance:"none",m:0,p:0,width:40,height:24,color:"primary",bg:"transparent",border:"1px solid",borderColor:"primary",borderRadius:9999,"&[aria-checked=true]":{bg:"primary"},":focus":{outline:"none",boxShadow:"0 0 0 2px"}}}),g().createElement(X.xu,{"aria-hidden":!0,style:{transform:n?"translateX(16px)":"translateX(0)"},sx:{mt:"-1px",ml:"-1px",width:24,height:24,borderRadius:9999,border:"1px solid",borderColor:"primary",bg:"background",transitionProperty:"transform",transitionTimingFunction:"ease-out",transitionDuration:"0.1s",variant:"forms.switch.thumb"}}))});var eh=n(47842),em=n(94944),ef=n(38521),eg="留资卡片",ev=function(e){var t=e.className,n=void 0===t?"":t,i=e.eventData,r=e.onClose,o=e.onSubmit,a=e.extra,c=i.token,s=i.name,l=i.intro,u=i.submitText,d=a.originPhone,p=(0,_._)((0,f.useState)(d),2),h=p[0],m=p[1],v=function(e){W.Z.trackEvent(e.target,{id:9972,action:"Submit"}),o({token:c,phone:h})};return g().createElement(q.eV,{block:"EcomMessageEventModal",content:{type:ef.UG.event}},g().createElement(q.Wi,{zaText:eg,zaType:"Popup"},g().createElement(j.Z,{options:[{},{},{id:9971,name:eg}]},g().createElement(eh.Z,{title:s,onClose:r,className:G()("KfeCollection-MessageEventModal",n),key:c},g().createElement("div",{className:"KfeCollection-MessageEventModal-intro"},l),g().createElement(eo,{className:"KfeCollection-MessageEventModal-phone",placeholder:"点击输入用户手机号码",value:h,onChange:function(e){m(e.target.value)},fontSize:"14px",color:"GBK02A",width:"100%"}),g().createElement("div",{className:"KfeCollection-MessageEventModal-buttonGroup"},g().createElement(q.$U,{zaType:"Button",zaAction:"Unknown",zaText:"取消",onClick:function(e){W.Z.trackEvent(e.target,{id:9972,action:"Cancel"}),r()}},g().createElement(em.ZP,{className:"KfeCollection-MessageEventModal-cancelButton"},"取消")),h?g().createElement(q.$U,{zaType:"Button",zaAction:"Unknown",zaText:u||"确认报名"},g().createElement(em.ZP,{onClick:v,preset:em.EE.Primary,color:em.rp.Blue,type:"submit"},u||"确认报名")):g().createElement(em.ZP,{onClick:v,disabled:!h,preset:em.EE.Primary,color:em.rp.Blue,type:"submit"},u||"确认报名"))))))};ev.propTypes={className:m().string,eventData:m().object.isRequired,extra:m().shape({ua:m().object,theme:m().string,originPhone:m().any}).isRequired,onClose:m().func,onSubmit:m().func};var eb=n(61763),ew=n(87804),ex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,ew.Z)("ui/showToast").dispatch({icon:"fail",text:(0,eb.n$)(e)})},e_=n(67927),ey=n(66857),ek=function(e){var t,n=e.data,i=void 0===n?{}:n,r=e.title;return{cardData:(0,H._)((0,x._)({},i),{name:i.name||r,coverPath:i.cover}),sendModalData:(0,H._)((0,x._)({},i),{name:i.name||r,submitText:null==i?void 0:null===(t=i.formFields)||void 0===t?void 0:t.submitText})}},eZ=function(e){var t=e.senderId,n=e.message,i=e.isEcomMerchant,r=(0,v.useDispatch)(),o=(0,v.useSelector)(function(e){var t;return null===(t=e.account.accountInfo)||void 0===t?void 0:t.phoneNo}),a=(0,_._)((0,f.useState)({}),2),c=a[0],s=a[1],l=(0,_._)((0,f.useState)(!1),2),d=l[0],p=l[1],h=function(e){var t=e.info;if(i&&"receiver"===n.userType){r((0,e_.c0)("商家不能参与自己发起的活动哦"));return}s((0,x._)({},t)),p(!0)},m=(0,f.useMemo)(function(){return(0,Z.camelizeKeys)(n)},[n]),g=m.ecomCard,b=void 0===g?{}:g,w=(0,f.useMemo)(function(){return ek(b)},[b]),y=function(){p(!1)},k=function(e){var n=e.cardType,i=e.modalData;if(1===n){var o=i.token,a=i.phone;r((0,T.RW)({contentType:"ecomcard",token:o,data:{receiverId:t,phone:a}})).then(function(){y()}).catch(ex)}};return(0,u.BX)(u.HY,{children:[1===b.cardType&&(0,u.tZ)(K.Z,{result:(0,H._)((0,x._)({},w.cardData),{id:m.id}),extra:{},isInMessage:!0,hasClickZA:!i||i&&"sender"===n.userType,onClick:function(){return h({type:"event",info:w.sendModalData,camelMessage:m})}}),2===b.cardType&&(0,u.tZ)(ey.Z,{message:(0,H._)((0,x._)({},n),{text:"web 上暂不支持优惠券消息，请至 app 查看"})}),d&&(0,u.tZ)(ev,{eventData:c,extra:{originPhone:o},onSubmit:function(e){return k({cardType:1,modalData:e})},onClose:y})]})},eM=n(65733),eC=n(99447),eS=function(e){return new RegExp(/https:\/\/www.zhihu.com\/inbox\/+[\s\S]*?is_ecom=1/).test(e)},eE=function(e){var t=e.senderId,n=e.message,i=e.isEcomMerchant,r=void 0!==i&&i,o=(0,v.useDispatch)(),a=(0,q.Q4)().trackEvent,s=(0,_._)((0,f.useState)(""),2),l=s[0],d=s[1],p=(0,eM.Z)(function(e){if(!e)return"";var t=new DOMParser().parseFromString(e,"text/html"),n=t.querySelectorAll("a");if(!n.length)return"";n.forEach(function(e){eS(e.href)&&e.setAttribute("data-za-not-track-link",!0)}),d(t.querySelector("body").innerHTML)});(0,f.useEffect)(function(){p(n.richText||n.text)},[p,n]);var h=function(e){var i,r=n.id,a=n.contentType;o((0,T.bG)({contentType:a,receiverId:t,data:(i={},(0,c._)(i,a,n[a]),(0,c._)(i,"text",e.target.text||"问题等待配置"),i),tempMessageId:r}))},m=(0,eM.Z)(function(e){var t=e.target,i=t.tagName,c=t.href;if("A"===i){if(c&&!eS(c))return;if(e.stopPropagation(),e.preventDefault(),r&&"receiver"===n.userType){o((0,e_.c0)("您不可以点击自己的卡片哦"));return}W.Z.trackEvent(e.target,{id:9969,action:"Click",name:"欢迎语卡片"},{module:[{card:{content:{type:"Message",id:String(n.id)}}}]}),a({block:"EcomWelcome",action:"Unknown",eventType:"Click",elementLocation:{type:"Text",content:{type:"Message",id:n.id}}}),h(e)}});return(0,u.tZ)("div",{className:G()("TextMessage","EcomWelcomeTextMessage",{"TextMessage-sender":"sender"===n.userType,"TextMessage-receiver":"receiver"===n.userType}),children:(0,u.tZ)(q.eV,{block:"MessageEcomWelcomeCard",content:{type:"Message",id:n.id},children:(0,u.tZ)(q.Wi,{zaType:"Card",zaAction:"Unknown",zaText:"交付欢迎语卡片",zaEventType:"Unknown",onClick:m,children:(0,u.tZ)(eC.r,{trackCardShow:!0,view:{id:9968,name:"欢迎语卡片"},extra:{module:[{card:{content:{id:String(n.id)}}}]},children:(0,u.tZ)(B.Text,{dangerouslySetInnerHTML:{__html:l}})})})})})},eT=n(68339),eR=n(81956),eI=function(e){var t=e.message,n=t.csevaluationCard,i=void 0===n?{}:n,r=i.material,o=i.isChecked,a=i.title,c=i.subTitle,s=t.id,l=(0,_._)((0,f.useState)(void 0!==o&&o),2),d=l[0],p=l[1],h=(0,_._)((0,f.useState)(void 0===r?[]:r),2),m=h[0],g=h[1],v=(0,_._)((0,f.useState)([]),2),b=v[0],w=v[1],y=(0,eR.Z)(),k=d?"感谢您的评价":a,Z=d?"我们已收到您的评价，感谢您的意见":c,M=(0,f.useMemo)(function(){return d?b.filter(function(e){return e.isChecked}):b},[d,b]),C=(0,f.useMemo)(function(){return d?m.filter(function(e){return e.isChecked}):m},[d,m]),S=(0,f.useMemo)(function(){return m.findIndex(function(e){return e.isChecked})},[m]),E=S>=0&&!d;return(0,f.useEffect)(function(){var e;w((null===(e=m.find(function(e){return e.isChecked}))||void 0===e?void 0:e.labels)||[])},[m]),(0,u.BX)(B.Box,{textAlign:"center",width:252,children:[(0,u.tZ)(B.Text,{fontSize:"17px",fontWeight:"bold",color:"GBK02A",children:k}),(0,u.tZ)(B.Text,{fontSize:"14px",color:"GBK06A",mt:"12px",children:Z}),(0,u.tZ)(B.Flex,{justifyContent:d?"center":"space-between",mt:20,children:C.map(function(e,t){return(0,u.BX)(B.Flex,{css:{cursor:"pointer"},justifyContent:"center",alignItems:"center",flexDirection:"column",children:[(0,u.tZ)(B.Image,{alt:"表情".concat(t),onClick:function(){d||g(function(e){return e.map(function(e,n){return(0,H._)((0,x._)({},e),{isChecked:n===t})})})},size:44,src:e.isChecked?e.selectedIcon:e.disableIcon}),(0,u.tZ)(B.Text,{mt:"12px",color:"GBK06A",fontSize:"14px",children:e.title})]},t)})}),!!M.length&&(0,u.tZ)(B.Flex,{justifyContent:"space-between",mt:"22px",css:{flexWrap:"wrap"},children:null==M?void 0:M.map(function(e,t){return(0,u.tZ)(eT.ZP,{onClick:function(){d||w(function(e){return e.map(function(e,n){return(0,H._)((0,x._)({},e),{isChecked:n===t^e.isChecked})})})},css:{width:"124px",height:"32px",marginBottom:"4px"},preset:"secondary",color:e.isChecked?"blue":"grey",size:"small",children:e.name},t)})}),E&&(0,u.tZ)(eT.ZP,{preset:"primary",color:"blue",size:"spread",css:{marginTop:"11px"},onClick:function(){var e=b.filter(function(e){return e.isChecked}).map(function(e){return e.id});y("/api/v4/messages/".concat(s,"/evaluation"),{method:"post",body:{selected_material:S,selected_labels:e}}).then(function(){p(!0)})},children:"提交"})]})},eB=function(e){var t=e.message,n=e.senderId;return(0,u.tZ)(B.Flex,{justifyContent:"center",alignItems:"center",maxWidth:400,children:(0,u.tZ)(B.Box,{bg:"GBK10A",p:"24px 62px",css:{borderRadius:"8px"},children:(0,u.tZ)(eI,{message:void 0===t?{}:t,senderId:n})})})},ez=n(30851),eN=Object.assign;function eA(e){var t;return g().createElement(ez.Z,eN(eN({width:"16",height:"16",viewBox:"0 0 16 16"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--ThumbFill16"+(t?" "+t:"")}),g().createElement("path",{d:"M6.728.767c-.624-.06-1.066.42-1.138.911-.245 1.696-1.204 3.045-2.744 3.867-.614.328-1.096.973-1.096 1.76l.003 1.454c.002 1.054.004 2.106.002 3.16A2.026 2.026 0 0 0 3.78 13.95h6.83a2.658 2.658 0 0 0 2.577-2.007l1.15-4.549a2.022 2.022 0 0 0-1.96-2.517H9.135c.094-.77.095-1.625-.162-2.364a2.605 2.605 0 0 0-.789-1.173c-.393-.326-.884-.518-1.457-.573Z"}))}var eD=Object.assign;function eL(e){var t;return g().createElement(ez.Z,eD(eD({width:"16",height:"16",viewBox:"0 0 16 16"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--ThumbDownFill16"+(t?" "+t:"")}),g().createElement("path",{d:"M9.293 15.584c.624.06 1.067-.42 1.138-.911.246-1.696 1.205-3.045 2.745-3.868.614-.328 1.096-.973 1.095-1.76L14.27 7.59a756.671 756.671 0 0 1-.002-3.16A2.026 2.026 0 0 0 12.242 2.4H5.411a2.658 2.658 0 0 0-2.577 2.006l-1.15 4.55a2.022 2.022 0 0 0 1.96 2.517h3.242c-.094.77-.095 1.626.162 2.364.15.435.399.851.788 1.174.393.325.885.517 1.457.573Z"}))}var eP=Object.assign;function eO(e){var t;return g().createElement(ez.Z,eP(eP({width:"16",height:"16",viewBox:"0 0 16 16"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--Thumb16"+(t?" "+t:"")}),g().createElement("path",{fillRule:"evenodd",d:"M6.993 2.355C6.575 4.32 5.363 5.9 3.553 6.868c-.21.112-.303.291-.303.436l.003 1.448c.002 1.056.004 2.113.002 3.17 0 .292.236.528.525.528h6.83c.53 0 .993-.36 1.123-.874l1.149-4.55a.522.522 0 0 0-.506-.649H8.8c-.775 0-1.303-.704-1.191-1.41.12-.763.12-1.466-.052-1.962a1.113 1.113 0 0 0-.328-.51.91.91 0 0 0-.236-.14ZM5.59 1.678c.072-.492.514-.971 1.138-.911.573.055 1.064.247 1.457.573.39.322.638.738.789 1.173.257.739.256 1.594.162 2.364h3.24a2.022 2.022 0 0 1 1.96 2.517l-1.149 4.55a2.658 2.658 0 0 1-2.576 2.006H3.78a2.026 2.026 0 0 1-2.025-2.031c.002-1.054 0-2.106-.002-3.16L1.75 7.306c0-.788.482-1.433 1.096-1.76 1.54-.823 2.499-2.172 2.744-3.868Z",clipRule:"evenodd"}))}var eU=Object.assign;function eH(e){var t;return g().createElement(ez.Z,eU(eU({width:"16",height:"16",viewBox:"0 0 16 16"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--ThumbDown16"+(t?" "+t:"")}),g().createElement("path",{fillRule:"evenodd",d:"M9.029 13.996c.417-1.966 1.63-3.547 3.44-4.514.209-.112.303-.29.303-.436l-.003-1.448a761.364 761.364 0 0 1-.002-3.17.526.526 0 0 0-.525-.528H5.411c-.53 0-.993.36-1.123.874L3.14 9.324c-.083.33.166.65.506.65h3.577c.775 0 1.302.703 1.19 1.409-.12.764-.12 1.467.053 1.962.081.235.193.4.328.51a.91.91 0 0 0 .236.14Zm1.402.677c-.07.491-.514.97-1.137.91-.573-.055-1.065-.247-1.458-.572a2.606 2.606 0 0 1-.788-1.173c-.257-.74-.256-1.595-.162-2.365H3.645a2.022 2.022 0 0 1-1.96-2.517l1.149-4.55A2.658 2.658 0 0 1 5.41 2.4h6.831c1.122 0 2.027.912 2.025 2.03-.002 1.054 0 2.107.002 3.161l.002 1.453c.001.788-.48 1.433-1.095 1.76-1.54.824-2.5 2.173-2.745 3.869Z",clipRule:"evenodd"}))}var eK=function(e){var t=e.csKnowledgeInfo,n=e.id,i=(0,eR.Z)(),r=(0,_._)((0,f.useState)(t.solveStatus||0),2),o=r[0],a=r[1],c=function(e){i("/api/v4/messages/".concat(n,"/evaluation"),{method:"post",body:{selected_material:e,scene:"cs_knowledge"}}).then(function(){})},s=function(e){return{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:e.colors.GBK10A,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer"}},l=function(){o||(a(1),c(1))},d=function(){o||(a(2),c(2))};return(0,u.tZ)("div",{css:function(e){return{svg:{width:"12px",height:"12px",color:e.colors.MapText06A}}},children:1===o?(0,u.tZ)("div",{css:function(e){return(0,H._)((0,x._)({},s(e)),{svg:{color:e.colors.MapBrand}})},children:(0,u.tZ)(eA,{})}):2===o?(0,u.tZ)("div",{css:function(e){return(0,x._)({},s(e))},children:(0,u.tZ)(eL,{})}):(0,u.BX)(q.Wi,{zaType:"Button",zaModuleId:"message_machine_ans_vote_btn",css:function(e){return{"> div":s(e)}},view:{elementLocation:{content:{type:"Message",id:n}}},children:[(0,u.tZ)(q.$U,{zaModuleId:"message_machine_ans_vote_btn",zaType:"Button",zaAction:"Upvote",css:{marginBottom:"4px"},onClick:function(){l()},view:{elementLocation:{content:{type:"Message",id:n}}},children:(0,u.tZ)(eO,{})}),(0,u.tZ)(q.$U,{zaModuleId:"message_machine_ans_vote_btn",zaType:"Button",zaAction:"Downvote",onClick:function(){d()},view:{elementLocation:{content:{type:"Message",id:n}}},children:(0,u.tZ)(eH,{})})]})})},eF=n(88423),eG=n(81488),eW=function(e){(0,s._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,c._)((0,r._)(e),"state",{previewImg:null,imageUrl:e.props.image.url}),(0,c._)((0,r._)(e),"getImageStyle",function(){var t=e.props.image,n=t.width,i=t.height,r=i/n;return i>U.g1||n>U.g1?r>1?{height:"".concat(U.g1,"px"),minWidth:"".concat(U.WG,"px")}:r<1?{width:"".concat(U.g1,"px"),minHeight:"".concat(U.WG,"px"),height:U.g1*r}:{height:"".concat(U.g1,"px"),width:"".concat(U.g1,"px")}:{maxWidth:"".concat(U.g1,"px"),maxHeight:"".concat(U.g1,"px"),width:n,height:i}}),(0,c._)((0,r._)(e),"isTempUrl",function(e){return e.startsWith("blob")}),(0,c._)((0,r._)(e),"handleImageClick",function(t){var n=e.state.imageUrl;e.isTempUrl(n)||e.setState({previewImg:t.target})}),e}return(0,a._)(n,[{key:"componentDidUpdate",value:function(){var e=this,t=this.props.image.url,n=this.state.imageUrl;t!==n&&(0,eF.loadImage)(t).then(function(){e.setState({imageUrl:t}),URL.revokeObjectURL(n)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.imageUrl,i=t.previewImg;return(0,u.BX)("div",{children:[(0,u.tZ)("img",{alt:"",className:G()("ImageMessage",{"ImageMessage--temp":this.isTempUrl(n)}),src:(0,eF.imgUrl)(n,"hd"),onClick:this.handleImageClick,style:this.getImageStyle()}),i&&(0,u.tZ)(eG.Z,{className:"ImageMessage-ImageView",img:i,onClose:function(){return e.setState({previewImg:null})}})]})}}]),n}(f.Component);(0,c._)(eW,"propTypes",{image:m().shape({width:m().number,height:m().number,url:m().string})});var ej=n(57029),eq=(0,f.memo)(function(e){var t=e.item,n=e.onListItemClick;return(0,u.BX)(q.$U,{as:B.Flex,zaType:"Text",zaBlock:"IconItem",alignItems:"center",justifyContent:"center",sx:function(e){return{width:"calc(25% - 9px)",height:"70px",backgroundColor:e.colors.GBK10A,borderRadius:"8px",flexFlow:"column wrap","&:hover":{backgroundColor:e.colors.GBK09A,cursor:"pointer"},"&:nth-child(n+5)":{marginTop:"12px"}}},onClick:function(){n(t.title)},children:[(0,u.tZ)(B.Image,{src:t.icon,width:20,height:20}),(0,u.tZ)(B.Text,{color:"GBK04A",fontSize:13,width:"100%",textAlign:"center",mt:"7px",children:t.title})]})}),eX=function(e){var t=e.icons,n=e.onListItemClick;return(0,u.tZ)(q.eV,{block:"IconListMessage",children:(0,u.tZ)(q.Wi,{zaType:"Block",as:B.Flex,className:"IconListMessage",sx:{maxWidth:"388px",flexFlow:"row wrap",justifyContent:"space-between",margin:t.length?"16px 8px 0 8px":"0"},children:null==t?void 0:t.map(function(e){return(0,u.tZ)(eq,{item:e,onListItemClick:n},e.title)})})})},eV=n(44812),e$=(0,f.memo)(function(e){var t=e.item,n=e.onListItemClick;return(0,u.tZ)(q.$U,{as:B.Text,zaType:"Text",zaBlock:"CardListItem",onClick:function(){n(t)},color:"GBL07A",py:"12px",pr:14,pl:12,fontSize:14,sx:function(e){return{"&:last-child":{borderRadius:" 0px 0px 8px 8px"},"&:not(:last-child)":{boxShadow:"inset 0px -0.5px 0px ".concat(e.colors.GBK09B)},"&:hover":{backgroundColor:e.colors.GBK09A,cursor:"pointer"}}},children:t})}),eY=function(e){var t=e.card,n=e.replySource,i=e.onListItemClick,r=t.title,o=t.refresh,a=t.list,c=t.pageSize,s=(0,_._)((0,f.useState)(0),2),l=s[0],d=s[1],p=(0,f.useMemo)(function(){return a.slice(l,l+c)},[a,l,c]),h=(0,f.useCallback)(function(){d(l+c>=a.length?0:l+c)},[l,c,a.length]);return(0,u.tZ)(q.eV,{block:"CardMessage",extra:{configMap:{replySource:"".concat(n)}},children:(0,u.BX)(q.Wi,{zaType:"Block",as:B.Box,className:"CardMessage",bg:"GBK10A",css:function(e){return{position:"relative",width:"388px",borderRadius:"8px",marginRight:"8px",marginLeft:"8px",fontSize:"14px",lineHeight:1,"&::before":{content:'""',position:"absolute",width:"8px",height:"8px",left:"-4px",top:"14px",background:e.colors.GBK10A,transform:"rotate(45deg)"}}},children:[r&&(0,u.BX)(B.Flex,{py:15,pr:14,pl:12,alignItems:"center",justifyContent:"space-between",sx:function(e){return{boxShadow:"inset 0px -0.5px 0px ".concat(e.colors.GBK09B)}},children:[(0,u.tZ)(B.Text,{color:"GBK03A",fontSize:1,fontWeight:500,children:r}),o&&(0,u.BX)(B.Text,{onClick:h,color:"GBL05A",fontWeight:500,sx:function(e){return{"&:hover":{color:e.colors.GBL07A,cursor:"pointer"}}},children:[(0,u.tZ)(eV.Z,{css:{verticalAlign:"middle"},size:18}),(0,u.tZ)("span",{css:{verticalAlign:"middle",marginLeft:"4px"},children:"换一批"})]})]}),(0,u.tZ)(B.Box,{children:p.map(function(e){return(0,u.tZ)(e$,{item:e,onListItemClick:i},e)})})]})})},eJ=(0,f.memo)(function(e){var t=e.message,n=e.senderId,i=e.sendMessage,r=t.plugin,o=r.pluginContent,a=r.pluginType,c=(0,Z.camelizeKeys)(JSON.parse(o)),s=c.card,l=c.tabs,d=c.replySource,p=(0,f.useCallback)(function(e){i({contentType:U.wF.text,receiverId:n,replySource:d,data:{text:e}})},[n,i,d]);return a===U.AX.GUESS_YOU_WANT_ASK?(0,u.tZ)(q.eV,{block:"PluginMessage",children:(0,u.BX)(B.Box,{className:"PluginMessage",children:[(0,u.tZ)(eY,{card:s,replySource:d,onListItemClick:p}),(0,u.tZ)(eX,{icons:l,onListItemClick:p})]})}):""}),eQ=n(36892),e0=n(38889),e1="3d198a56310c02c4a83efb9f4a4c027e",e2=["https://www.zhihu.com/staffService/"+e1],e4=(0,f.createContext)({showModal:!1,setShowModal:function(){return null}});function e5(e){var t=e.item,n=e.selected,i=e.onClick,r=(0,eM.Z)(function(){return i(t)});return(0,u.tZ)(e0.ZP,{label:t.name,color:n?e0.rp.Blue:e0.rp.Grey,preset:e0.EE.Secondary,css:{marginRight:"8px"},onClick:r},t.id)}function e6(e){var t=e.senderId,n=e.showModal,i=e.onClose,r=(0,_._)((0,f.useState)([]),2),o=r[0],a=r[1],c=(0,_._)((0,f.useState)(null),2),s=c[0],l=c[1],d=(0,v.useDispatch)(),p=(0,eR.Z)();(0,f.useEffect)(function(){n&&p("/api/v4/customer_service/question_tag",{ignoreCode:!0}).then(function(e){var t;a((null===(t=e.payload)||void 0===t?void 0:t.data)||[])}).catch(function(){return null})},[n,p]);var h=(0,eM.Z)((0,eQ.Z)(function(e){p("/api/v4/customer_service/choose_question_tag",{method:"POST",body:{adminId:e1,tagId:e.id},ignoreCode:!0}).catch(function(){return null}),d((0,T.bG)({contentType:U.wF.text,receiverId:t,data:{text:e.name}})),i(),l(null)},300)),m=(0,eM.Z)(function(e){l(e.id),h(e)});return(0,u.tZ)(eh.Z,{css:{width:"694px",".Modal-content":{padding:"0 0 55px 0",marginTop:0}},onClose:i,children:n&&(0,u.BX)(u.HY,{children:[(0,u.tZ)("div",{css:function(e){return{padding:"12px 0 10px 20px",fontSize:"20px",lineHeight:"28px",borderBottom:"1px solid "+e.colors.GBK09A,color:e.colors.GBK02A}},children:"选个问题类型，小管家为你解答"}),o.map(function(e){return(0,u.BX)(f.Fragment,{children:[(0,u.tZ)("div",{css:function(e){return{marginTop:"20px",paddingLeft:"20px",fontSize:"15px",lineHeight:"18px",color:e.colors.GBK03A}},children:e.categoryName}),(0,u.tZ)("div",{css:{marginTop:"16px",paddingLeft:"20px"},children:e.items.map(function(e){return(0,u.tZ)(e5,{item:e,selected:s===e.id,onClick:m},e.id)})})]},e.categoryId)})]})})}var e8=function(e){var t=e.message,n=e.onRequestReport,i=e.onRequestBlock,r=(0,f.useRef)(),o=(0,f.useContext)(e4),a=o.showModal,c=o.setShowModal;return(0,u.tZ)(B.Text,{ref:r,m:"20px auto",p:"10px 12px",bg:"GBK10A",color:"GBK07A",maxWidth:388,minHeight:40,fontSize:12,sx:{lineHeight:"20px",borderRadius:"8px",a:{color:"primary"}},dangerouslySetInnerHTML:{__html:(0,f.useMemo)(function(){return t.text.replace("https://www.zhihu.com/report?report_location=1","#report").replace("http://www.zhihu.com/defriend","#block")},[t.text])},onClick:function(e){var t=e.target.href;t&&((e.preventDefault(),n&&t.endsWith("#report"))?(n(),W.Z.trackEvent(r.current,{action:"Click",id:6882})):i&&t.endsWith("#block")?(i(),W.Z.trackEvent(r.current,{action:"Click",id:6883})):e2.includes(t)?a||c(!0):t.includes("/consult/sendCard")||t.includes("/consult/me/settings")?z.Z.alert("PC 端暂不支持该操作，请打开 App 操作"):window.open(t,"_blank"))}})},e7=function(e){(0,s._)(n,e);var t=(0,l._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"render",value:function(){var e=this.props.sticker.url;return(0,u.tZ)("img",{className:"StickerMessage",src:(0,eF.imgUrl)(e,"xl"),alt:""})}}]),n}(f.Component);(0,c._)(e7,"propTypes",{sticker:m().shape({id:m().string,url:m().string})});var e3=function(e){(0,s._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,c._)((0,r._)(e),"ref",(0,f.createRef)()),(0,c._)((0,r._)(e),"state",{isMoreActionMenuShow:!1,isShieldUserModalShown:!1}),(0,c._)((0,r._)(e),"handleDocClick",function(t){!e.state.isMoreActionMenuShow||!e.ref.current||e.ref.current.contains(t.target)||(t.stopPropagation(),t.preventDefault(),e.setState({isMoreActionMenuShow:!1}))}),(0,c._)((0,r._)(e),"toggleMoreActionMenu",function(){e.setState({isMoreActionMenuShow:!e.state.isMoreActionMenuShow})}),(0,c._)((0,r._)(e),"handleMessageDelete",function(){var t=e.props,n=t.deleteMessage,i=t.message.id,r=t.sender.id;z.Z.confirm((0,u.tZ)("div",{style:{textAlign:"center"},children:"是否删除该条消息"}),{title:"删除消息"}).then(function(){return n(i,r)},function(){})}),(0,c._)((0,r._)(e),"handleReSendMessage",function(){var t=e.props,n=t.deleteLocalMessage,i=t.sender.id,r=t.sendMessage,o=t.message,a=o.id,s=o.contentType;if(s!==U.wF.ecomcard){if(s!==U.wF.image)n(a,i),r({contentType:s,receiverId:i,data:(0,c._)({},s,o[s]),tempMessageId:a});else{var l=o.image.url;if(l.startsWith("blob")){var u=o.file,d=e.props,p=d.uploadImage,h=d.setImageSendFailure;p(u).then(function(e){return r({contentType:U.wF.image,receiverId:i,data:{image:{height:e.payload.dataRawheight,width:e.payload.dataRawwidth,url:e.payload.src}},tempMessageId:a})}).then(function(){URL.revokeObjectURL(l)}).catch(function(){h({tempMessageId:a,receiverId:i,file:u})})}else r({contentType:s,receiverId:i,data:(0,c._)({},s,o[s]),tempMessageId:a})}}}),(0,c._)((0,r._)(e),"handleReSendIconClick",function(){z.Z.confirm(null,{title:"是否重新发送消息"}).then(function(){e.handleReSendMessage()},function(){})}),(0,c._)((0,r._)(e),"renderMessage",function(t){var n=e.props,i=n.sender.id,r=n.isEcomMerchant,o=n.sendMessage,a=t.isEcomWelcomeCard;return t.contentType===U.wF.text?a?(0,u.tZ)(eE,{senderId:i,message:t,isEcomMerchant:r}):(0,u.tZ)(ey.Z,{message:t,senderId:i,sendMessage:o}):t.contentType===U.wF.image?(0,u.tZ)(eW,{image:t.image}):t.contentType===U.wF.sticker?(0,u.tZ)(e7,{sticker:t.sticker}):t.contentType===U.wF.ecomcard?(0,u.tZ)(eZ,{senderId:i,message:t,isEcomMerchant:r}):t.contentType===U.wF.plugin?(0,u.tZ)(N.SV,{replacement:(0,u.tZ)(B.Box,{children:"无法识别的消息"}),children:(0,u.tZ)(eJ,{senderId:i,message:t,sendMessage:o})}):t.contentType===U.wF.csevaluationcard?(0,u.tZ)(eB,{message:t,senderId:i}):"web 上暂不支持此类消息，请至 app 查看"}),(0,c._)((0,r._)(e),"handleReportClick",function(){var t=e.props,n=t.toggleSelectMessage,i=t.toggleReportModal;n(!0,t.message),i()}),(0,c._)((0,r._)(e),"renderMessageStatus",function(t){var n=e.props.onMultiSelectClick;if(t===U.Gs.success){var i=e.state.isMoreActionMenuShow,r="receiver"===e.props.message.userType;return(0,u.tZ)("div",{className:"Message-status--wrapper",children:(0,u.tZ)(O.Z,{ref:e.ref,isOpen:i,onToggleMenu:e.toggleMoreActionMenu,onDeleteClick:e.handleMessageDelete,onReportClick:e.handleReportClick,onMultiSelectClick:n,showReport:!r})})}return t===U.Gs.loading?(0,u.tZ)(A.Z,{className:"Message-status--loading"}):t===U.Gs.failure?(0,u.tZ)(I.G,{className:"Message-status--failure",onClick:e.handleReSendIconClick}):null}),(0,c._)((0,r._)(e),"selectStateChange",function(t){var n=e.props,i=n.toggleSelectMessage,r=n.message;i(t.currentTarget.checked,r)}),(0,c._)((0,r._)(e),"renderMessageByType",function(){var t=e.props,n=t.message,i=t.receiver,r=t.multiSelectMode,o=t.isMessageSelected,a=t.sender,c=t.hideMessageStatus,s=n.userType,l=n.id,d=n.status,p=n.contentType,h=n.extraInfo,m=(void 0===h?{}:h).csKnowledgeInfo,f=void 0===m?null:m;if(U.wF.csevaluationcard===p)return(0,u.tZ)(B.Flex,{width:"100%",justifyContent:"center",children:e.renderMessage(n)});var g="receiver"===s,v=g?i:a,b=!g&&r;return(0,u.tZ)(ej.XP,{className:"Message",message:n,isReceiver:g,renderAvatar:function(){return(0,u.BX)(u.HY,{children:[b&&(0,u.tZ)(R.C,{css:{borderRadius:"50%",marginRight:22},checked:o,onChange:e.selectStateChange}),(0,u.tZ)(D.Z,{user:v,size:40})]})},renderMessage:function(){return(0,u.BX)(u.HY,{children:[e.renderMessage(n),!c&&!f&&(0,u.tZ)("div",{className:"Message-status",children:e.renderMessageStatus(d)}),f&&(0,u.tZ)("div",{css:{alignSelf:"flex-end"},children:(0,u.tZ)(eK,{csKnowledgeInfo:f,id:l})})]})}})}),e}return(0,a._)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocClick)}},{key:"render",value:function(){var e=this,t=this.props,n=t.message,i=t.sender,r=n.type,o=n.showTime,a=n.createdTime,c=this.state.isShieldUserModalShown,s=(0,u.tZ)(u.HY,{children:o&&(0,u.tZ)(ej.eS,{time:a})});return"risk_tip"===r||"tip"===r?(0,u.BX)(u.HY,{children:[s,c&&(0,u.tZ)(L.Z,{shown:c,onClose:function(){return e.setState({isShieldUserModalShown:!1})},user:i}),(0,u.tZ)(e8,{message:n,onRequestReport:this.handleReportClick,onRequestBlock:function(){e.setState({isShieldUserModalShown:!0})}})]}):(0,u.BX)("div",{className:"Message-wrapper",children:[s,this.renderMessageByType()]})}}]),n}(f.Component);(0,c._)(e3,"propsTypes",{message:m().object,sender:m().object,receiver:m().object});var e9=(0,v.connect)(null,{deleteMessage:T.$Z,deleteLocalMessage:T.Rn,sendMessage:T.bG,setImageSendFailure:T.Hf,uploadImage:P.Ix})(e3),te=function(e){(0,s._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,c._)((0,r._)(e),"state",{showQuestionTagModal:!1}),(0,c._)((0,r._)(e),"scrollToBottom",function(){e.messageBoxEle&&(e.messageBoxEle.scrollTop=e.messageBoxEle.scrollHeight)}),(0,c._)((0,r._)(e),"handleGetHistoryMessage",function(t){var n=e.props,i=n.isLoading,r=n.getHistoryMessages,o=n.senderId,a=n.isEnd;!t||i||a||r({senderId:o})}),(0,c._)((0,r._)(e),"setShowQuestionTagModal",function(t){return e.setState({showQuestionTagModal:t})}),e}return(0,a._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.getHistoryMessages,n=e.senderId,i=e.messages,r=e.setMessageRead,o=e.sender,a=e.location.query;0!==i.length&&(void 0===o?{}:o).id?this.scrollToBottom():t({senderId:n,clientScene:a.client_scene}).catch(function(){location.href="//www.zhihu.com/messages"}),r(n)}},{key:"componentDidUpdate",value:function(e){var t=e.messages,n=void 0===t?[]:t,i=this.props,r=i.messages,o=i.setMessageRead,a=i.senderId,c=n[n.length-1]||{},s=r[r.length-1]||{};c.id!==s.id&&(this.scrollToBottom(),"sender"===s.userType&&o(a));var l=e.sender,u=(void 0===l?{}:l).id,d=this.props.sender;(void 0===d?{}:d).id!==u&&this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props,n=t.messages,i=t.receiver,r=t.sender,o=void 0===r?{}:r,a=t.senderId,c=t.isLoading,s=t.isEcomMerchant,l=t.multiSelectMode,h=t.selectedMessages,m=t.onMultiSelectClick,f=t.toggleSelectMessage,g=t.toggleReportModal,v=t.hideMessageStatus,b=this.state.showQuestionTagModal;return o.id?(0,u.BX)(e4.Provider,{value:{showModal:b,setShowModal:this.setShowQuestionTagModal},children:[(0,u.tZ)(p.ZP,{isLoading:c,onLoad:this.handleGetHistoryMessage,placeholder:(0,u.tZ)(d.Z,{className:"MessagesBox-loading"}),isPrevDrained:!1,isDrained:!0,getContainer:function(e){return e},className:"MessagesBox",onRef:function(t){e.messageBoxEle=t},children:n.map(function(e){return(0,u.tZ)("div",{children:(0,u.tZ)(e9,{message:e,receiver:i,sender:o,isEcomMerchant:s,multiSelectMode:l,isMessageSelected:h.find(function(t){return t.id===e.id}),toggleSelectMessage:f,onMultiSelectClick:m,toggleReportModal:g,hideMessageStatus:v})},e.tempMessageId||e.id)})}),(0,u.tZ)(e6,{showModal:b,onClose:function(){return e.setShowQuestionTagModal(!1)},senderId:a})]}):(0,u.tZ)(d.Z,{className:"MessagesBox-loading"})}}]),n}(f.Component);(0,c._)(te,"PropsTypes",{senderId:m().string});var tt=(0,w.compose)(b.withRouter,(0,v.connect)(function(e,t){var n=t.senderId,i=e.chat.chats[n]||{},r=i.receiver,o=i.sender,a=i.messages,c=i.isLoading,s=i.isEnd;return{receiver:void 0===r?{}:r,sender:void 0===o?{}:o,messages:void 0===a?[]:a,isLoading:void 0!==c&&c,isEnd:void 0===s||s,isEcomMerchant:(e.chat.chats||{}).isEcomMerchant}},{getHistoryMessages:T.fb,setMessageRead:T.BI}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.alwaysShow,n=void 0!==t&&t;return function(e){return k()(function(t){var i=(0,_._)((0,f.useState)(!1),2),r=i[0],o=i[1];return(0,f.useEffect)(function(){if((0,M.Wb)()){o(!0);return}(window.zh_emoticon?Promise.resolve(E(window.zh_emoticon)):(0,S.v)("https://unpkg.zhimg.com/@cfe/emoticon@1.2.4/lib/emoticon.js").then(function(){return window.zh_emoticon?E(window.zh_emoticon):[]})).then(function(e){(0,M.Uh)((0,Z.camelizeKeys)(e)),o(!0)}).catch(function(){o(!0)})},[]),(r||n)&&(0,u.tZ)(e,(0,x._)({},t))},e)}}())(te)},94307:function(e,t,n){"use strict";n.d(t,{D5:function(){return v},pl:function(){return x}});var i=n(55164),r=n(57477),o=n(71728),a=n(94009),c=n(85879),s=n(83697),l=n(71549),u=n.n(l),d=n(87363),p=n(87641),h=n(43384),m=n(87804),f=function(e,t){if(!t)return e;var n=(0,a._)(e.split("#"),2),i=n[0],r=n[1],o=i+(i.includes("?")?"&":"?")+t;return r?o+"#"+r:o},g=function(e,t){var n,i=function(){var n,i,r,o,a,c=null,s=null;t.WxMiniProgram?c=null===(i=window.wx)||void 0===i?void 0:null===(r=i.miniProgram)||void 0===r?void 0:r.navigateTo:t.JDMiniProgram&&(c=null===(o=window.jd)||void 0===o?void 0:null===(a=o.miniProgram)||void 0===a?void 0:a.navigateTo);var l=null===(n=/\/topic\/(\d+)/.exec(e))||void 0===n?void 0:n[1];if(l&&(t.WxMiniProgram?s="/pages/topic?id=".concat(l):t.JDMiniProgram&&(s="/pages/topic/index?id=".concat(l))),s){null==c||c({url:s});return}/^http(s)?:/.test(e)&&(location.href=e)};!t.WxMiniProgram||(null===(n=window.WeixinJSBridge)||void 0===n?void 0:n.invoke)?i():document.addEventListener("WeixinJSBridgeReady",i,!1)},v=function(e){return/^\w+:\/\//.test(e)||"undefined"==typeof window?e:/^\/\//.test(e)?location.protocol+e:location.origin+e},b=function(e,t){var n=t.params,i=t.onRequestOpen,r=(0,s.n)();return function(t){var o=e.href,a=e.onClick;if(a&&a(t),!t.defaultPrevented){var c=f(v(o),n);if(r.ZhihuHybrid){t.preventDefault(),(0,m.Z)("base/openURL").dispatch({url:c});return}if(r.isMiniProgram){t.preventDefault(),g(c,r);return}(null==i?void 0:i({ua:r,url:c}))&&t.preventDefault()}}},w=function(e,t){var n=t.extra;return{zaType:"Button",zaAction:"OpenUrl",zaEventType:"Click",shouldTrackClick:!0,extra:u()({link:{get url(){return v(e)}}},n)}},x=(0,d.forwardRef)(function(e,t){var n=e.params,a=e.onRequestOpen,s=e.extra,l=(0,o._)(e,["params","onRequestOpen","extra"]);return(0,c.tZ)(h.KC,(0,r._)((0,i._)({as:p.Link},w(l.href,{extra:s}),l),{ref:t,onClick:b(l,{params:n,onRequestOpen:a})}))});t.ZP=function(e){var t=e.params,n=e.onRequestOpen,a=e.children,c=e.extra,s=(0,o._)(e,["params","onRequestOpen","children","extra"]);return(0,d.cloneElement)(a,(0,h.qz)((0,r._)((0,i._)({},w(a.props.href,{extra:c}),s),{ref:a.ref,onClick:b(a.props,{params:t,onRequestOpen:n})})))}},81488:function(e,t,n){"use strict";var i=n(20857),r=n(22107),o=n(94707),a=n(87320),c=n(86325),s=n(55164),l=n(85626),u=n(85879),d=n(16836),p=n(92073),h=n(25628),m=n.n(h),f=n(14168),g=n.n(f),v=n(87363),b=n.n(v),w=n(87641),x=n(88423),_=n(17132),y=n.n(_),k={top:10,left:20},Z={top:0,left:0},M=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),(0,a._)((0,i._)(e),"scrollerRef",b().createRef()),(0,a._)((0,i._)(e),"state",{transEnded:!1,rect:null,translate:null,scale:null}),(0,a._)((0,i._)(e),"getBoundingClientRect",function(){var t=e.props,n=t.img,i=t.data,r=n.getBoundingClientRect(),o=r.left,a=r.top,c=r.width,s=r.height,l=i.width,u=i.height,d={left:o,top:a,width:c,height:s},p=1;return l>u?(d.height=s,p=s/u,d.width=l*p,d.left=o+(c-d.width)/2,d.top=a+(s-d.height)/2):l<u&&(d.width=c,p=c/l,d.height=u*p,d.left=o+(c-d.width)/2,d.top=a+(s-d.height)/2),d}),(0,a._)((0,i._)(e),"handleClick",function(t){t.stopPropagation(),e.setState({translate:null,scale:null})}),(0,a._)((0,i._)(e),"handleKeyDown",function(t){"Escape"===t.key&&(t.stopPropagation(),t.preventDefault(),e.setState({translate:null,scale:null}))}),(0,a._)((0,i._)(e),"handleTransitionEnd",function(){var t=e.state,n=t.translate,i=t.scale,r=e.props.onClose;n&&i?(e.setState({transEnded:!0}),e.scrollerRef.current.style.overflow="auto"):r()}),e}return(0,o._)(n,[{key:"originalSrc",get:function(){return this.props.img.dataset.original}},{key:"currentSrc",get:function(){var e=this.props.img;return e.currentSrc||e.src}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.img,n=e.isOriginalUrl;this.originalSrc!==this.currentSrc&&(new Image().src=this.originalSrc),this.setState({rect:!1===n?this.getBoundingClientRect():t.getBoundingClientRect()})}},{key:"componentDidMount",value:function(){var e=this;(0,p.disableBodyScroll)(this.scrollerRef.current);var t=this.props.img;setTimeout(function(){return e.setState((0,s._)({},e.computeTransition(e.state.rect,{width:t.dataset.rawwidth||t.naturalWidth})))})}},{key:"componentWillUnmount",value:function(){(0,p.enableBodyScroll)(this.scrollerRef.current)}},{key:"computeTransition",value:function(e,t){var n,i=this.props,r=i.transitionType,o=i.data,a=y()(navigator.userAgent).Mobile?Z:k,c=a.top,s=a.left,l={left:0,top:0,width:window.innerWidth,height:window.innerHeight},u={x:l.left+l.width/2,y:l.top+l.height/2},d={width:l.width-2*s,height:l.height-2*c},p={},h={};return 1===r?(p.width=d.width>o.width?o.width:d.width,n=p.width/o.width,p.height=o.height*n,h={x:(d.width-p.width)/2+s,y:p.height<d.height?(d.height-p.height)/2+c:k.top}):(p.width=d.width>t.width?t.width:d.width,n=p.width/e.width,p.height=e.height*n,h={x:u.x-e.width/2,y:(p.height<d.height?u.y:k.top+p.height/2)-e.height/2}),{translate:h,scale:n}}},{key:"render",value:function(){var e,t=this,n=this.props,i=n.img,r=n.isOriginalUrl,o=n.data,a=n.transitionType,c=n.className,s=this.state,l=s.translate,p=s.scale,h=s.rect,f=s.transEnded,g=l&&p,v=1,b="";if(1===a){var _=(y()(navigator.userAgent).Mobile?Z:k).left;e=Math.min(window.innerWidth-2*_,o.width);var M=h.width/e;b=g?"translate(".concat(l.x,"px, ").concat(l.y,"px) scale(1) "):"translate(".concat(h.left,"px, ").concat(h.top,"px) scale(").concat(M,") "),v=g?1:0}else b=g?"translate(".concat(l.x,"px ,").concat(l.y,"px) scale(").concat(p,") "):"translate(".concat(h.left,"px,").concat(h.top,"px)");return(0,u.tZ)(d.Z,{children:(0,u.tZ)(w.Box,{className:m()("ImageView",c,{"is-active":g}),style:{paddingBottom:k.top},onClick:this.handleClick,onKeyDown:this.handleKeyDown,children:(0,u.tZ)("div",{className:"ImageView-inner",ref:this.scrollerRef,children:(0,u.tZ)("img",{ref:function(e){t.imgEl=e},src:!1===r?(0,x.imgUrl)(i.dataset.original,"r"):f&&this.originalSrc||this.currentSrc,className:m()("ImageView-img",{"ImageView-transformOrigin":1===a}),style:{width:e||h.width,transform:b,opacity:v},onTransitionEnd:this.handleTransitionEnd,alt:"preview"})})})})}}]),n}(v.Component);(0,a._)(M,"propTypes",{img:g().object.isRequired,onClose:g().func.isRequired}),t.Z=M},3426:function(e,t,n){"use strict";var i=n(20857),r=n(22107),o=n(94707),a=n(87320),c=n(86325),s=n(15030),l=n(55164),u=n(57477),d=n(71728),p=n(85626),h=n(85879),m=n(25628),f=n.n(m),g=n(14168),v=n.n(g),b=n(87363),w=n(61533),x=n(17002),_=n(90746),y=n(4526),k=n(49978),Z=n(58357),M=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),(0,a._)((0,i._)(e),"listenNodeDisconnect",function(){}),(0,a._)((0,i._)(e),"state",{placement:e.props.placement}),(0,a._)((0,i._)(e),"position",function(){var t=e.props,n=t.target,i=t.container,r=t.placement,o=t.fixed,a=t.boundary;if(e.element&&n){var c=(0,s._)(n,HTMLElement)?n:(0,w.findDOMNode)(n),l=document.body;i&&(l=(0,s._)(i,HTMLElement)?i:(0,w.findDOMNode)(i));var u=(0,Z.Z)(c.getBoundingClientRect(),(0,_.Z)(a,l),e.element.getBoundingClientRect(),r);o||(u.targetContainerStyle.left+=window.pageXOffset,u.targetContainerStyle.top+=window.pageYOffset),e.setState(u)}}),(0,a._)((0,i._)(e),"handleRef",function(t){e.element=t,e.props.onRef(t)}),(0,a._)((0,i._)(e),"handleAfterEnter",function(){e.position()}),e}return(0,o._)(n,[{key:"listenNode",value:function(e){if("function"==typeof MutationObserver){var t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,childList:!0,subtree:!0}),{isSuccess:!0,disconnect:t.disconnect}}return{isSuccess:!1}}},{key:"componentDidMount",value:function(){if(this.props.isListenNode){var e=this.listenNode(this.position),t=e.isSuccess,n=e.disconnect;t&&(this.listenNodeDisconnect=n)}this.props.listenResize&&window.addEventListener("resize",this.position)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.target,i=t.repositionKey;(e.target!==n||e.repositionKey!==i)&&requestAnimationFrame(this.position)}},{key:"componentWillUnmount",value:function(){this.props.isListenNode&&this.listenNodeDisconnect(),this.props.listenResize&&window.removeEventListener("resize",this.position)}},{key:"render",value:function(){var e,t=this.props,n=t.isOpen,i=t.arrowed,r=t.fixed,o=t.children,c=t.className,s=(t.placement,t.repositionKey,t.onRef,t.listenResize,t.target,t.container,t.boundary,(0,d._)(t,["isOpen","arrowed","fixed","children","className","placement","repositionKey","onRef","listenResize","target","container","boundary"])),p=this.state,m=p.arrowStyle,g=p.targetContainerStyle,v=p.placement,b=n&&(0,h.BX)("div",(0,u._)((0,l._)({className:f()(c,"Popover-content","Popover-content--".concat(v),k.Z.content,k.Z["content--".concat(v)],(e={"Popover-content--fixed":r,"Popover-content--arrowed":i},(0,a._)(e,k.Z["content--fixed"],r),(0,a._)(e,k.Z["content--arrowed"],i),e)),ref:this.handleRef,style:g},s),{children:[i&&(0,h.tZ)("span",{className:f()("Popover-arrow","Popover-arrow--".concat(v),k.Z.arrow,k.Z["arrow--".concat(v)]),style:m}),o]}));return(0,h.tZ)(x.Z,{onAfterEnter:this.handleAfterEnter,transitionName:k.Z.content,timeout:200,children:b})}}]),n}(b.Component);(0,a._)(M,"propTypes",{isOpen:v().bool,arrowed:v().bool,fixed:v().bool,placement:v().oneOf(Object.keys(y).map(function(e){return y[e]})),repositionKey:v().string,onRef:v().func,listenResize:v().bool,container:v().object,boundary:v().shape({getElement:v().func,padding:v().number,getBoundaryInfo:v().func}),isListenNode:v().bool}),(0,a._)(M,"defaultProps",{isOpen:!1,arrowed:!1,fixed:!1,placement:"bottom",onRef:function(){}}),t.Z=M},57665:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var i=n(85879),r=n(14168),o=n.n(r),a=n(25628),c=n.n(a),s=Array.from(Array(12),function(e,t){return(0,i.tZ)("span",{className:"Spinner-blade-12"},t)});function l(e){var t=e.className,n=e.white,r=e.large;return(0,i.tZ)("div",{className:c()("Spinner-blade",t,{"Spinner-blade--large":r,"Spinner-blade--white":n}),children:s})}l.propTypes={className:o().string,large:o().bool,white:o().bool};var u=l},60051:function(e,t,n){"use strict";var i=n(55164),r=n(57477),o=n(71728),a=n(85879),c=n(41283),s=n(87641),l=n(94307),u=n(18837),d=n.n(u),p=n(88423),h=d()(p.findImageSpec),m=function(e,t){return(0,p.imgUrl)(e,h(t))};t.Z=function(e){var t=e.user,n=e.size,u=void 0===n?38:n,d=e.noBadge,p=e.noLink,h=void 0!==p&&p,f=e.linkProps,g=(0,o._)(e,["user","size","noBadge","noLink","linkProps"]),v=t.avatarUrl,b=t.isOrg,w=t.urlToken,x=!h&&w?"https://www.zhihu.com/".concat(b?"org":"people","/").concat(w):null,_=(0,a.tZ)(s.Image,{loading:"lazy",src:m(v,u),srcSet:"".concat(m(v,2*u)," 2x"),size:u,display:"block",css:{borderRadius:"50%"}});return(0,a.BX)(s.Box,(0,r._)((0,i._)({display:"inline-block",size:u,css:{position:"relative"}},g),{children:[x?(0,a.tZ)(l.pl,(0,r._)((0,i._)({href:x,target:"_blank"},f),{children:_})):_,!(void 0!==d&&d)&&(0,a.tZ)(c.Vh,{css:(0,c.FJ)(u),isOrg:b,badge:t.badgeV2||t.badge,linkify:!h,enableTooltip:!0})]}))}},73718:function(e,t,n){"use strict";var i=n(20857),r=n(22107),o=n(94707),a=n(86325),c=n(85626),s=n(85879),l=n(87363),u=n(36695),d=n(47842),p=n(38889),h=n(67927),m=n(6438),f=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){var e;return(0,r._)(this,n),(e=t.call(this)).handleShieldUser=e.handleShieldUser.bind((0,i._)(e)),e}return(0,o._)(n,[{key:"handleShieldUser",value:function(){var e=this.props,t=e.dispatch,n=e.user.urlToken,i=e.onClose;t((0,m.cR)(n,!0)).then(function(){return t((0,h.c0)("屏蔽成功"))}),i()}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.shown,i=e.user;return(0,s.tZ)(d.Z,{onClose:t,title:"确定要屏蔽".concat(i.name,"？"),children:n&&(0,s.BX)("div",{children:["屏蔽后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你、邀请你回答问题，但仍然可以查看你的公开信息。",(0,s.BX)(d.w,{direction:"horizontal",children:[(0,s.tZ)(p.ZP,{onClick:t,color:"grey",children:"取消"}),(0,s.tZ)(p.ZP,{preset:"primary",color:"blue",onClick:this.handleShieldUser,children:"确定"})]})]})})}}]),n}(l.Component);t.Z=(0,u.connect)()(f)},91486:function(e,t,n){"use strict";var i,r,o,a=n(87320),c=n(94009),s=n(85879),l=n(87363),u=n(25628),d=n.n(u),p=n(6706),h=n(91724),m=n(36963),f=n(85224);(i=r||(r={})).Square="square",i.Circle="circle";var g=(o={},(0,a._)(o,r.Square,[p.Z,h.Z]),(0,a._)(o,r.Circle,[m.ZP,f.ZP]),o);t.C=function(e){var t=e.className,n=e.id,i=e.name,o=e.size,a=void 0===o?20:o,u=e.checked,p=e.onChange,h=e.disabled,m=e.shape,f=void 0===m?r.Square:m,v=(0,c._)((0,l.useState)(!1),2),b=v[0],w=v[1],x=g[f],_=u?x[0]:x[1];return(0,s.BX)("label",{className:d()("Checkbox",t,{"Checkbox--focused":b,"Checkbox--disabled":h}),css:[{cursor:"pointer",display:"inline-flex"},b&&{outline:"none",transition:"box-shadow 0.3s"},h&&{cursor:"no-drop",opacity:"0.4"}],children:[u?(0,s.tZ)(_,{size:a,className:"Checkbox-iconOn",css:function(e){return{color:e.colors.GBL01A}}}):(0,s.tZ)(_,{size:a,className:"Checkbox-iconOff",css:function(e){return{color:e.colors.GBK06A}}}),(0,s.tZ)("input",{className:"Checkbox-input",id:n,name:i,type:"checkbox",checked:u,onFocus:function(){return w(!0)},onBlur:function(){return w(!1)},onChange:p,disabled:h,css:{appearance:"none",clip:"rect(0, 0, 0, 0)",pointerEvents:"none",position:"absolute"}})]})}},19860:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var i=n(87363),r=n.n(i),o=n(25628),a=n.n(o),c=n(14168),s=n.n(c),l=n(69383),u=n(71542),d=n(43384),p=n(38521),h="留资卡片",m=function(e){var t=e.result,n=e.isInMessage,i=e.onClick,o=t.name,c=t.coverPath,s=t.className,l=void 0===s?"":s,u=t.intro;return r().createElement("div",{className:a()("KfeCollection-MessageEventCard",l,{"KfeCollection-MessageEventCard--InMessage":n}),onClick:i},r().createElement("img",{src:void 0===c?"https://i1.wp.com/pic4.zhimg.com/80/v2-231f5c4e7db8b6c08493a220be85705e_hd.png?ssl=1":c,className:"KfeCollection-MessageEventCard-cover"}),r().createElement("div",{className:"KfeCollection-MessageEventCard-content"},r().createElement("div",{className:"KfeCollection-MessageEventCard-title"},o),r().createElement("div",{className:"KfeCollection-MessageEventCard-text"},u)))},f=function(e){var t=e.result,n=e.onClick,i=e.isInMessage,o=void 0!==i&&i,a=e.hasClickZA,c=void 0===a||a,s=t.token,f=t.id;return r().createElement(d.eV,{block:"EcomMessageEventCard",content:{type:p.UG.event,id:f}},r().createElement(d.Wi,{shouldTrackClick:c,zaType:"Card",zaAction:"Unknown",zaText:h,zaEventType:"Unknown",onClick:function(e){c&&l.Z.trackEvent(e.target,{id:o?9970:10048,action:"Click",name:h}),n(s)}},r().createElement(u.Z,{options:[{},o?{card:{content:{id:String(f)}}}:{},{id:o?9968:10046,name:h}]},r().createElement(m,{result:t,isInMessage:o}))))};f.propTypes={className:s().string,result:s().object.isRequired,extra:s().shape({ua:s().object,theme:s().string}).isRequired};var g=f},38521:function(e,t,n){"use strict";n.d(t,{FR:function(){return l},H7:function(){return u},UG:function(){return p},Xo:function(){return c},at:function(){return d},ie:function(){return s}});var i=n(55164),r=n(57477),o={Rectangle:"Rectangle",Square:"Square"};o.Square,o.Square,o.Rectangle;var a={general:"general",live:"live",publication:"publication",album:"album",special:"special",manga:"manga",course:"km_course"};(0,r._)((0,i._)({},a),{album_chapter:a.album,album_video_chapter:a.album,album_paid_column:a.album,paid_column_chapter:a.album,training:a.album,training_bundle:a.album,training_chapter:a.album,web_literature:a.publication,instabook:a.publication,ebook_audio:a.publication,publication_chapter:a.publication,publication_paid_magazine:a.publication,magazine_section:a.publication,paid_answer:a.album,assessment:a.album,playlet:a.album}),a.album;var c={live:"Live 讲座",album:"盐选专栏",album_paid_column:"盐选专栏",album_chapter:"盐选专栏",album_video_chapter:"盐选专栏",paid_column_chapter:"盐选专栏",publication:"电子书",publication_chapter:"电子书章节",instabook:"讲书",ebook_audio:"有声书",publication_paid_magazine:"盐选杂志",special:"专题",training:"训练营",training_bundle:"训练营",training_chapter:"训练营",web_literature:"网络文学",magazine_section:"杂志文章",manga:"漫画",course:"课程",class:"盐选专栏"},s={live:"Live 讲座",album:"盐选专栏",album_chapter:"盐选专栏",album_video_chapter:"盐选专栏",album_paid_column:"盐选专栏",paid_column_chapter:"盐选专栏",assessment:"盐选专栏",training:"盐选专栏",training_bundle:"盐选专栏",training_chapter:"盐选专栏",publication:"电子书",publication_chapter:"电子书",instabook:"电子书",ebook_audio:"电子书",publication_paid_magazine:"电子书",special:"电子书",web_literature:"电子书",magazine_section:"电子书",manga:"电子书",course:"课程",class:"盐选专栏"},l={live:a.live,album:a.album,album_chapter:a.album,album_paid_column:a.album,album_video_chapter:a.album,training:a.album,training_bundle:a.album,training_chapter:a.album,paid_column_chapter:a.album,assessment:a.album,publication:a.publication,publication_chapter:a.publication,instabook:a.publication,ebook_audio:a.publication,publication_paid_magazine:a.publication,special:a.publication,web_literature:a.publication,magazine_section:a.publication,manga:a.publication,course:a.course},u=["live","album","album_chapter","album_video_chapter","paid_column_chapter","publication_chapter","magazine_section","album_paid_column","assessment","special"],d={PaidAnswer:"PaidAnswer",PaidPost:"PaidPost",Answer:"Answer",Post:"Post",Conversation:"Conversation"},p={paid_magazine:"PaidMagazine",paid_column:"PaidColumn",paid_column_chapter:"PaidColumn",album:"RemixAlbum",ebook:"EBook",instabook:"InstaBook",literature:"Literature",training:"Training",training_bundle:"TrainingBundle",special:"Special",ebook_audio:"AudioBook",live:"Live",publication:"EBook",web_literature:"EBook",album_chapter:"RemixAlbum",album_paid_column:"RemixAlbum",album_video_chapter:"RemixAlbum",manga:"Manga",free_conversation:"FreeConversation",event:"Event",Onebox:"OneBox",paid_answer:"Answer"}},71542:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var i=n(20857),r=n(22107),o=n(94707),a=n(86325),c=n(49899),s=n(85626),l=n(14168),u=n.n(l),d=n(87363),p=n.n(d),h=n(61533),m=n(4667),f=n.n(m),g=n(75472),v=n.n(g),b=n(69383),w=n(84871),x=n.n(w);function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=f()(function(){var e=new IntersectionObserver(function(t){t.forEach(function(t){if(0!==t.intersectionRatio){var n=t.target;e.unobserve(n),n.handleChange&&(n.handleChange(),n.handleChange=null)}})},{threshold:[.1]});return e}),k=function(e,t,n,l){return function(u){var m=function(d){(0,a._)(f,d);var m=(0,s._)(f);function f(){for(var e,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return(0,r._)(this,f),e=m.call.apply(m,[this].concat((0,c._)(n))),_((0,i._)(e),"values_",{}),_((0,i._)(e),"trackCardShow",function(){var t=e.values,n=t.viewInfo,i=t.extraInfo;b.Z.trackCardShow(e.element,n,i)}),e}return(0,o._)(f,[{key:"values",get:function(){return this.values_},set:function(e){v()(e,this.values_)||(this.values_=e,this.setModule())}},{key:"parseValues",value:function(){var i,r=this,o=function(e){return"function"==typeof e?e(r.props):e};this.values={viewLocation:e,moduleInfo:(i=o(t))?i.type||i.sub_type?{card:{card_type:"Content",content:i}}:i:null,viewInfo:o(n),extraInfo:o(l)}}},{key:"setModule",value:function(){var e=this.values,t=e.viewLocation,n=e.moduleInfo;b.Z.setModule(this.element,t,n)}},{key:"componentDidMount",value:function(){this.element=(0,h.findDOMNode)(this),this.parseValues(),this.values.viewInfo&&(this.element.handleChange=this.trackCardShow,y().observe(this.element))}},{key:"componentDidUpdate",value:function(){this.parseValues()}},{key:"componentWillUnmount",value:function(){this.values.viewInfo&&(y().unobserve(this.element),this.element.handleChange=null),this.element=null}},{key:"render",value:function(){return p().createElement(u,this.props)}}]),f}(d.Component);return x()(m,u),m.displayName="".concat("track","(").concat(u.displayName||u.name||"Component",")"),m}},Z=function(e){(0,a._)(n,e);var t=(0,s._)(n);function n(){for(var e,o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];return(0,r._)(this,n),e=t.call.apply(t,[this].concat((0,c._)(a))),_((0,i._)(e),"Component",k.apply(void 0,(0,c._)(e.props.options))(function(){return e.props.children})),e}return(0,o._)(n,[{key:"render",value:function(){return"undefined"!=typeof window&&window.IntersectionObserver?p().createElement(this.Component,null):this.props.children}}]),n}(d.Component);_(Z,"propTypes",{children:u().element.isRequired,options:u().array.isRequired});var M=Z},91724:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},r:function(){return s}});var i=n(87363),r=n.n(i),o=n(30851),a=Object.assign;function c(e){var t;return r().createElement(o.Z,a(a({width:"24",height:"24",viewBox:"0 0 24 24"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--CheckBoxOff24"+(t?" "+t:"")}),r().createElement("path",{fillRule:"evenodd",d:"M18.6 4.5H5.4a.9.9 0 0 0-.9.9v13.2a.9.9 0 0 0 .9.9h13.2a.9.9 0 0 0 .9-.9V5.4a.9.9 0 0 0-.9-.9ZM5.4 3A2.4 2.4 0 0 0 3 5.4v13.2A2.4 2.4 0 0 0 5.4 21h13.2a2.4 2.4 0 0 0 2.4-2.4V5.4A2.4 2.4 0 0 0 18.6 3H5.4Z",clipRule:"evenodd"}))}function s(e){return r().createElement(c,a(a({},e),{className:function(){return"Zi Zi--CheckboxOff"+(e.className?" "+e.className:"")}}))}},6706:function(e,t,n){"use strict";n.d(t,{B:function(){return s},Z:function(){return c}});var i=n(87363),r=n.n(i),o=n(30851),a=Object.assign;function c(e){var t;return r().createElement(o.Z,a(a({width:"24",height:"24",viewBox:"0 0 24 24"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--CheckBoxOnFill24"+(t?" "+t:"")}),r().createElement("path",{fillRule:"evenodd",d:"M3 5.4A2.4 2.4 0 0 1 5.4 3h13.2A2.4 2.4 0 0 1 21 5.4v13.2a2.4 2.4 0 0 1-2.4 2.4H5.4A2.4 2.4 0 0 1 3 18.6V5.4Zm8.145 8.184L9.04 11.481a.75.75 0 0 0-1.06 1.06l2.628 2.63c.002 0 .004.003.005.004a.75.75 0 0 0 1.06 0l4.746-4.745a.75.75 0 0 0-1.061-1.06l-4.214 4.214Z",clipRule:"evenodd"}))}function s(e){return r().createElement(c,a(a({},e),{className:function(){return"Zi Zi--CheckboxOn"+(e.className?" "+e.className:"")}}))}},36963:function(e,t,n){"use strict";n.d(t,{BS:function(){return s},ZP:function(){return c}});var i=n(87363),r=n.n(i),o=n(30851),a=Object.assign;function c(e){var t;return r().createElement(o.Z,a(a({width:"24",height:"24",viewBox:"0 0 24 24"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--CheckCircleFill24"+(t?" "+t:"")}),r().createElement("path",{fillRule:"evenodd",d:"M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Zm-11.056 1.584-2.103-2.103a.75.75 0 0 0-1.06 1.06l2.628 2.63c.002 0 .003.003.005.004a.75.75 0 0 0 1.06 0l4.746-4.745a.75.75 0 0 0-1.061-1.06l-4.215 4.214Z",clipRule:"evenodd"}))}function s(e){return r().createElement(c,a(a({},e),{className:function(){return"Zi Zi--CheckCircle"+(e.className?" "+e.className:"")}}))}},64011:function(e,t,n){"use strict";n.d(t,{G:function(){return s},Z:function(){return c}});var i=n(87363),r=n.n(i),o=n(30851),a=Object.assign;function c(e){var t;return r().createElement(o.Z,a(a({width:"24",height:"24",viewBox:"0 0 24 24"},e),{className:"function"==typeof(t=e.className)?t():"ZDI ZDI--ExclamationCircleFill24"+(t?" "+t:"")}),r().createElement("path",{fillRule:"evenodd",d:"M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10ZM12 7a1 1 0 0 1 1 1v4.5a1 1 0 1 1-2 0V8a1 1 0 0 1 1-1Zm0 10.5a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z",clipRule:"evenodd"}))}function s(e){return r().createElement(c,a(a({},e),{className:function(){return"Zi Zi--Alert"+(e.className?" "+e.className:"")}}))}},92073:function(e,t){var n,i,r;i=[t],void 0!==(r="function"==typeof(n=function(e){"use strict";var t=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},n=function(e){return s.some(function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))})},i=function(e){var t=e||window.event;return!!n(t.target)||1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1)},r=function(){setTimeout(function(){void 0!==p&&(document.body.style.paddingRight=p,p=void 0),void 0!==d&&(document.body.style.overflow=d,d=void 0)})};Object.defineProperty(e,"__esModule",{value:!0});var o=!1;if("undefined"!=typeof window){var a={get passive(){o=!0}};window.addEventListener("testPassive",null,a),window.removeEventListener("testPassive",null,a)}var c="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints),s=[],l=!1,u=-1,d=void 0,p=void 0;e.disableBodyScroll=function(e,r){if(c){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");e&&!s.some(function(t){return t.targetElement===e})&&(s=[].concat(t(s),[{targetElement:e,options:r||{}}]),e.ontouchstart=function(e){1===e.targetTouches.length&&(u=e.targetTouches[0].clientY)},e.ontouchmove=function(t){var r;1===t.targetTouches.length&&(r=t.targetTouches[0].clientY-u,n(t.target)||(e&&0===e.scrollTop&&0<r||e&&e.scrollHeight-e.scrollTop<=e.clientHeight&&r<0?i(t):t.stopPropagation()))},l||(document.addEventListener("touchmove",i,o?{passive:!1}:void 0),l=!0))}else setTimeout(function(){if(void 0===p){var e=!!r&&!0===r.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(p=document.body.style.paddingRight,document.body.style.paddingRight=t+"px")}void 0===d&&(d=document.body.style.overflow,document.body.style.overflow="hidden")}),s=[].concat(t(s),[{targetElement:e,options:r||{}}])},e.clearAllBodyScrollLocks=function(){c?(s.forEach(function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),l&&(document.removeEventListener("touchmove",i,o?{passive:!1}:void 0),l=!1),s=[],u=-1):(r(),s=[])},e.enableBodyScroll=function(e){if(c){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,s=s.filter(function(t){return t.targetElement!==e}),l&&0===s.length&&(document.removeEventListener("touchmove",i,o?{passive:!1}:void 0),l=!1)}else(s=s.filter(function(t){return t.targetElement!==e})).length||r()}})?n.apply(t,i):n)&&(e.exports=r)},53967:function(e){e.exports=function(e){if("string"!=typeof e)return!1;var r=e.match(t);if(!r)return!1;var o=r[1];return!!o&&!!(n.test(o)||i.test(o))};var t=/^(?:\w+:)?\/\/(\S+)$/,n=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,i=/^[^\s\.]+\.\S{2,}$/}}]);
//# sourceMappingURL=shared-faeff54b296b1c154036fc9f6ca9c13ea6d336f2.c8aab027acdeb65b7e40.js.map